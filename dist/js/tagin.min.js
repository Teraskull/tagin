function tagin(el,option={}){const classElement="tagin",classWrapper="tagin-wrapper",classTags="tagin-tags",classTag="tagin-tag",classRemove="tagin-tag-remove",classInput="tagin-input",classInputHidden="tagin-input-hidden",defaultSeparator=",",defaultDuplicate="false",defaultTransform=e=>e,separator=el.dataset.separator||option.separator||defaultSeparator,duplicate=el.dataset.duplicate||option.duplicate||defaultDuplicate,transform=eval(el.dataset.transform)||option.transform||defaultTransform,templateTag=e=>`<span class="${classTag}">${e}<span class="${classRemove}"></span></span>`,getValue=()=>el.value,getValues=()=>el.value.split(separator),wrapper=()=>el.nextElementSibling,tagsWrapper=()=>wrapper().getElementsByClassName(classTags)[0],input=()=>wrapper().getElementsByClassName(classInput)[0],getTags=()=>[...wrapper().getElementsByClassName(classTag)].map(e=>e.textContent).join(separator),updateValue=()=>{el.value=getTags(),el.dispatchEvent(new Event("change"))};function autowidth(){const e=document.createElement("div");e.classList.add(classInput,classInputHidden),e.innerHTML=input().value.replace(/ /g,"&nbsp;"),document.body.appendChild(e),input().style.setProperty("width",Math.ceil(window.getComputedStyle(e).width.replace("px",""))+1+"px"),e.remove()}function alertExist(e){for(const a of wrapper().getElementsByClassName(classTag))a.textContent===e&&(a.style.transform="scale(1.09)",setTimeout(()=>{a.removeAttribute("style")},150))}function updateTag(){getValues().join(separator)!==getTags()&&(tagsWrapper().innerHTML=""===getValue().trim()?"":getValues().map(templateTag).join(""))}function escapeRegex(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}!function(){const e=classWrapper+" "+el.className.replace(classElement,"").trim(),a=`this.getElementsByClassName('${classInput}')[0].focus()`,t=""===getValue().trim()?"":getValues().map(templateTag).join(""),s=`\n    <div class="${e}" onclick="${a}">\n      <span class="${classTags}">${t}</span>\n      <input type="text" class="${classInput}" onfocus="this.parentNode.classList.add('focus')" onblur="this.parentNode.classList.remove('focus')">\n    </div>`;el.insertAdjacentHTML("afterend",s)}(),document.addEventListener("click",e=>{e.target.closest("."+classRemove)&&(e.target.closest("."+classRemove).parentNode.remove(),updateValue())}),input().addEventListener("keydown",e=>{""===input().value&&8===e.keyCode&&wrapper().getElementsByClassName(classTag).length&&(wrapper().querySelector("."+classTag+":last-child").remove(),updateValue())}),input().addEventListener("input",()=>{autowidth();const e=input().value.replace(new RegExp(escapeRegex(separator),"g"),"").trim();""===e&&(input().value=""),input().value.includes(separator)&&(getTags().split(separator).includes(e)&&"false"===duplicate?alertExist(e):(tagsWrapper().insertAdjacentHTML("beforeEnd",templateTag(transform(e))),updateValue()),input().value="",input().removeAttribute("style"))}),el.addEventListener("change",()=>updateTag())}